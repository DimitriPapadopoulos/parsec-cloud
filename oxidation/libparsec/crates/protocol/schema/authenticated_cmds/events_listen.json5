[
    {
        "major_versions": [
            4
        ],
        "req": {
            "cmd": "events_listen",
            // No `wait` param as this API is only meant to be used from SSE
            "fields": []
        },
        "reps": [
            {
                "status": "ok",
                "unit": "APIEvent"
            },
            {
                // Returned if the command is used through the regular rpc route
                // instead of the SSE one
                "status": "not_available"
            }
        ],
        "nested_types": [
            {
                "name": "APIEvent",
                "discriminant_field": "event",
                "variants": [
                    {
                        "name": "Pinged",
                        "discriminant_value": "pinged",
                        "fields": [
                            {
                                "name": "ping",
                                "type": "String"
                            }
                        ]
                    },
                    {
                        "name": "CertificatesUpdated",
                        "discriminant_value": "certificates_updated",
                        "fields": [
                            {
                                "name": "certificate",
                                "type": "Bytes"
                            }
                        ]
                    },
                    {
                        "name": "MessageReceived",
                        "discriminant_value": "message_received",
                        "fields": [
                            {
                                "name": "index",
                                "type": "Index"
                            },
                            {
                                "name": "message",
                                "type": "Bytes"
                            }
                        ]
                    },
                    {
                        "name": "InviteStatusChanged",
                        "discriminant_value": "invite_status_changed",
                        "fields": [
                            {
                                "name": "token",
                                "type": "InvitationToken"
                            },
                            {
                                "name": "invitation_status",
                                "type": "InvitationStatus"
                            }
                        ]
                    },
                    {
                        "name": "RealmMaintenanceStarted",
                        "discriminant_value": "realm_maintenance_started",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "encryption_revision",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "RealmMaintenanceFinished",
                        "discriminant_value": "realm_maintenance_finished",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "encryption_revision",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "RealmVlobsUpdated",
                        "discriminant_value": "realm_vlobs_updated",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "checkpoint",
                                "type": "Index"
                            },
                            {
                                "name": "src_id",
                                "type": "VlobID"
                            },
                            {
                                "name": "src_version",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "PkiEnrollmentUpdated",
                        "discriminant_value": "pki_enrollment_updated"
                    }
                ]
            }
        ]
    },
    {
        "major_versions": [
            2,
            3
        ],
        "req": {
            "cmd": "events_listen",
            "fields": [
                {
                    "name": "wait",
                    "type": "Boolean"
                }
            ]
        },
        "reps": [
            {
                "status": "ok",
                "unit": "APIEvent"
            },
            {
                "status": "cancelled",
                "fields": [
                    {
                        "name": "reason",
                        "type": "NonRequiredOption<String>"
                    }
                ]
            },
            {
                "status": "no_events"
            }
        ],
        "nested_types": [
            {
                "name": "APIEvent",
                "discriminant_field": "event",
                "variants": [
                    {
                        "name": "Pinged",
                        "discriminant_value": "pinged",
                        "fields": [
                            {
                                "name": "ping",
                                "type": "String"
                            }
                        ]
                    },
                    {
                        "name": "MessageReceived",
                        "discriminant_value": "message.received",
                        "fields": [
                            {
                                "name": "index",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "InviteStatusChanged",
                        "discriminant_value": "invite.status_changed",
                        "fields": [
                            {
                                "name": "token",
                                "type": "InvitationToken"
                            },
                            {
                                "name": "invitation_status",
                                "type": "InvitationStatus"
                            }
                        ]
                    },
                    {
                        "name": "RealmMaintenanceStarted",
                        "discriminant_value": "realm.maintenance_started",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "encryption_revision",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "RealmMaintenanceFinished",
                        "discriminant_value": "realm.maintenance_finished",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "encryption_revision",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "RealmVlobsUpdated",
                        "discriminant_value": "realm.vlobs_updated",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "checkpoint",
                                "type": "Index"
                            },
                            {
                                "name": "src_id",
                                "type": "VlobID"
                            },
                            {
                                "name": "src_version",
                                "type": "Index"
                            }
                        ]
                    },
                    {
                        "name": "RealmRolesUpdated",
                        "discriminant_value": "realm.roles_updated",
                        "fields": [
                            {
                                "name": "realm_id",
                                "type": "RealmID"
                            },
                            {
                                "name": "role",
                                "type": "RequiredOption<RealmRole>"
                            }
                        ]
                    },
                    {
                        "name": "PkiEnrollmentUpdated",
                        "discriminant_value": "pki_enrollment.updated"
                    }
                ]
            }
        ]
    }
]
