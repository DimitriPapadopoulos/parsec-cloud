{
    "family": "authenticated_cmds",
    "cmds": [
        {
            "label": "Ping",
            "req": {
                "cmd": "ping",
                "other_fields": [
                    {
                        "name": "ping",
                        "type": "String"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "pong",
                            "type": "String"
                        }
                    ]
                }
            ]
        },
        {
            "label": "BlockCreate",
            "req": {
                "cmd": "block_create",
                "other_fields": [
                    {
                        "name": "block_id",
                        "type": "BlockID"
                    },
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "block",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "already_exists",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "timeout",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "BlockRead",
            "req": {
                "cmd": "block_read",
                "other_fields": [
                    {
                        "name": "block_id",
                        "type": "BlockID"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "block",
                            "type": "Bytes"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "timeout",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "EventsListen",
            "req": {
                "cmd": "events_listen",
                "other_fields": [
                    {
                        "name": "wait",
                        "type": "Boolean"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "unit": "APIEvent",
                    "other_fields": []
                },
                {
                    "status": "cancelled",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "no_events",
                    "other_fields": []
                }
            ],
            "nested_types": [
                {
                    "label": "APIEvent",
                    "tag": "event",
                    "variants": [
                        {
                            "name": "Pinged",
                            "discriminant_value": "pinged",
                            "fields": [
                                {
                                    "name": "ping",
                                    "type": "String"
                                }
                            ]
                        },
                        {
                            "name": "MessageReceived",
                            "discriminant_value": "message.received",
                            "fields": [
                                {
                                    "name": "index",
                                    "type": "Index"
                                }
                            ]
                        },
                        {
                            "name": "InviteStatusChanged",
                            "discriminant_value": "invite.status_changed",
                            "fields": [
                                {
                                    "name": "token",
                                    "type": "InvitationToken"
                                },
                                {
                                    "name": "invitation_status",
                                    "type": "InvitationStatus"
                                }
                            ]
                        },
                        {
                            "name": "RealmMaintenanceFinished",
                            "discriminant_value": "realm.maintenance_finished",
                            "fields": [
                                {
                                    "name": "realm_id",
                                    "type": "RealmID"
                                },
                                {
                                    "name": "encryption_revision",
                                    "type": "Index"
                                }
                            ]
                        },
                        {
                            "name": "RealmMaintenanceStarted",
                            "discriminant_value": "realm.maintenance_started",
                            "fields": [
                                {
                                    "name": "realm_id",
                                    "type": "RealmID"
                                },
                                {
                                    "name": "encryption_revision",
                                    "type": "Index"
                                }
                            ]
                        },
                        {
                            "name": "RealmVlobsUpdated",
                            "discriminant_value": "realm.vlobs_updated",
                            "fields": [
                                {
                                    "name": "realm_id",
                                    "type": "RealmID"
                                },
                                {
                                    "name": "checkpoint",
                                    "type": "Index"
                                },
                                {
                                    "name": "src_id",
                                    "type": "VlobID"
                                },
                                {
                                    "name": "src_version",
                                    "type": "Index"
                                }
                            ]
                        },
                        {
                            "name": "RealmRolesUpdated",
                            "discriminant_value": "realm.roles_updated",
                            "fields": [
                                {
                                    "name": "realm_id",
                                    "type": "RealmID"
                                },
                                {
                                    "name": "role",
                                    "type": "RealmRole"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "label": "EventsSubscribe",
            "req": {
                "cmd": "events_subscribe",
                "other_fields": []
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "InviteNew",
            "req": {
                "cmd": "invite_new",
                "unit": "UserOrDevice",
                "other_fields": []
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "token",
                            "type": "InvitationToken"
                        },
                        // Field used when the invitation is correctly created but the invitation email cannot be sent
                        {
                            "name": "email_sent",
                            "type": "InvitationEmailSentStatus"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "already_member",
                    "other_fields": []
                },
                {
                    "status": "not_available",
                    "other_fields": []
                }
            ],
            "nested_types": [
                {
                    "label": "UserOrDevice",
                    "tag": "type",
                    "variants": [
                        {
                            "name": "User",
                            "discriminant_value": "USER",
                            "fields": [
                                {
                                    "name": "claimer_email",
                                    "type": "String"
                                },
                                {
                                    "name": "send_email",
                                    "type": "Boolean"
                                }
                            ]
                        },
                        {
                            "name": "Device",
                            "discriminant_value": "DEVICE",
                            "fields": [
                                {
                                    "name": "send_email",
                                    "type": "Boolean"
                                }
                            ]
                        }
                    ]
                },
                {
                    "label": "InvitationEmailSentStatus",
                    "variants": [
                        {
                            "name": "Success",
                            "discriminant_value": "SUCCESS",
                            "fields": []
                        },
                        {
                            "name": "NotAvailable",
                            "discriminant_value": "NOT_AVAILABLE",
                            "fields": []
                        },
                        {
                            "name": "BadRecipient",
                            "discriminant_value": "BAD_RECIPIENT",
                            "fields": []
                        }
                    ]
                }
            ]
        },
        {
            "label": "InviteDelete",
            "req": {
                "cmd": "invite_delete",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    },
                    {
                        "name": "reason",
                        "type": "InvitationDeletedReason"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                }
            ],
            "nested_types": [
                {
                    "label": "InvitationDeletedReason",
                    "variants": [
                        {
                            "name": "Finished",
                            "discriminant_value": "FINISHED",
                            "fields": []
                        },
                        {
                            "name": "Cancelled",
                            "discriminant_value": "CANCELLED",
                            "fields": []
                        },
                        {
                            "name": "Rotten",
                            "discriminant_value": "ROTTEN",
                            "fields": []
                        }
                    ]
                }
            ]
        },
        {
            "label": "InviteList",
            "req": {
                "cmd": "invite_list",
                "other_fields": []
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "invitations",
                            "type": "List<InviteListItem>"
                        }
                    ]
                }
            ],
            "nested_types": [
                {
                    "label": "InviteListItem",
                    "tag": "type",
                    "variants": [
                        {
                            "name": "User",
                            "discriminant_value": "USER",
                            "fields": [
                                {
                                    "name": "token",
                                    "type": "InvitationToken"
                                },
                                {
                                    "name": "created_on",
                                    "type": "DateTime"
                                },
                                {
                                    "name": "claimer_email",
                                    "type": "String"
                                },
                                {
                                    "name": "status",
                                    "type": "InvitationStatus"
                                }
                            ]
                        },
                        {
                            "name": "Device",
                            "discriminant_value": "DEVICE",
                            "fields": [
                                {
                                    "name": "token",
                                    "type": "InvitationToken"
                                },
                                {
                                    "name": "created_on",
                                    "type": "DateTime"
                                },
                                {
                                    "name": "status",
                                    "type": "InvitationStatus"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "label": "Invite1GreeterWaitPeer",
            "req": {
                "cmd": "invite_1_greeter_wait_peer",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    },
                    {
                        "name": "greeter_public_key",
                        "type": "PublicKey"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "claimer_public_key",
                            "type": "PublicKey"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                },
                {
                    "status": "invalid_state",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "Invite2aGreeterGetHashedNonce",
            "req": {
                "cmd": "invite_2a_greeter_get_hashed_nonce",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "claimer_hashed_nonce",
                            "type": "HashDigest"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                },
                {
                    "status": "invalid_state",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "Invite2bGreeterSendNonce",
            "req": {
                "cmd": "invite_2b_greeter_send_nonce",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    },
                    {
                        "name": "greeter_nonce",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "claimer_nonce",
                            "type": "Bytes"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                },
                {
                    "status": "invalid_state",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "Invite3aGreeterWaitPeerTrust",
            "req": {
                "cmd": "invite_3a_greeter_wait_peer_trust",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                },
                {
                    "status": "invalid_state",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "Invite3bGreeterSignifyTrust",
            "req": {
                "cmd": "invite_3b_greeter_signify_trust",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                },
                {
                    "status": "invalid_state",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "Invite4GreeterCommunicate",
            "req": {
                "cmd": "invite_4_greeter_communicate",
                "other_fields": [
                    {
                        "name": "token",
                        "type": "InvitationToken"
                    },
                    {
                        "name": "payload",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "payload",
                            "type": "Bytes"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_deleted",
                    "other_fields": []
                },
                {
                    "status": "invalid_state",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "MessageGet",
            "req": {
                "cmd": "message_get",
                "other_fields": [
                    {
                        "name": "offset",
                        "type": "Index"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "messages",
                            "type": "List<Message>"
                        }
                    ]
                }
            ],
            "nested_types": [
                {
                    "label": "Message",
                    "variants": [
                        {
                            "name": "",
                            "fields": [
                                {
                                    "name": "count",
                                    "type": "Size"
                                },
                                {
                                    "name": "sender",
                                    "type": "DeviceID"
                                },
                                {
                                    "name": "timestamp",
                                    "type": "DateTime"
                                },
                                {
                                    "name": "body",
                                    "type": "Bytes"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "label": "OrganizationStats",
            "req": {
                "cmd": "organization_stats",
                "other_fields": []
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "data_size",
                            "type": "Size"
                        },
                        {
                            "name": "metadata_size",
                            "type": "Size"
                        },
                        {
                            "name": "realms",
                            "type": "Size"
                        },
                        {
                            "name": "users",
                            "type": "Size"
                        },
                        {
                            "name": "active_users",
                            "type": "Size"
                        },
                        {
                            "name": "users_per_profile_detail",
                            "type": "List<UsersPerProfileDetailItem>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                }
            ],
            "nested_types": [
                {
                    "label": "UsersPerProfileDetailItem",
                    "variants": [
                        {
                            "name": "",
                            "fields": [
                                {
                                    "name": "profile",
                                    "type": "UserProfile"
                                },
                                {
                                    "name": "active",
                                    "type": "Index"
                                },
                                {
                                    "name": "revoked",
                                    "type": "Index"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "label": "OrganizationConfig",
            "req": {
                "cmd": "organization_config",
                "other_fields": []
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "user_profile_outsider_allowed",
                            "type": "Boolean"
                        },
                        // `None` stands for "no limit" here
                        {
                            "name": "active_users_limit",
                            "type": "Option<Size>"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "RealmCreate",
            "req": {
                "cmd": "realm_create",
                "other_fields": [
                    {
                        "name": "role_certificate",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "invalid_certification",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_data",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "already_exists",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "RealmStatus",
            "req": {
                "cmd": "realm_status",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "in_maintenance",
                            "type": "Boolean"
                        },
                        {
                            "name": "maintenance_type",
                            "type": "Option<MaintenanceType>"
                        },
                        {
                            "name": "maintenance_started_on",
                            "type": "Option<DateTime>"
                        },
                        {
                            "name": "maintenance_started_by",
                            "type": "Option<DeviceID>"
                        },
                        {
                            "name": "encryption_revision",
                            "type": "Index"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ],
            "nested_types": [
                {
                    "label": "MaintenanceType",
                    "variants": [
                        {
                            "name": "GarbageCollection",
                            "discriminant_value": "GARBAGE_COLLECTION",
                            "fields": []
                        },
                        {
                            "name": "Reencryption",
                            "discriminant_value": "REENCRYPTION",
                            "fields": []
                        }
                    ]
                }
            ]
        },
        {
            "label": "RealmStats",
            "req": {
                "cmd": "realm_stats",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "blocks_size",
                            "type": "Size"
                        },
                        {
                            "name": "vlobs_size",
                            "type": "Size"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "RealmGetRoleCertificates",
            "req": {
                "cmd": "realm_get_role_certificates",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "since",
                        "type": "Option<DateTime>"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "certificates",
                            "type": "List<Bytes>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "RealmUpdateRoles",
            "req": {
                "cmd": "realm_update_roles",
                "other_fields": [
                    {
                        "name": "role_certificate",
                        "type": "Bytes"
                    },
                    {
                        "name": "recipient_message",
                        "type": "Option<Bytes>"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_certification",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_data",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "already_granted",
                    "other_fields": []
                },
                {
                    "status": "incompatible_profile",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "RealmStartReencryptionMaintenance",
            "req": {
                "cmd": "realm_start_reencryption_maintenance",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    },
                    {
                        "name": "timestamp",
                        "type": "DateTime"
                    },
                    {
                        "name": "per_participant_message",
                        "type": "Map<UserID, Bytes>"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "participant_mismatch",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_data",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "maintenance_error",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "RealmFinishReencryptionMaintenance",
            "req": {
                "cmd": "realm_finish_reencryption_maintenance",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "not_in_maintenance",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "maintenance_error",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "UserGet",
            "req": {
                "cmd": "user_get",
                "other_fields": [
                    {
                        "name": "user_id",
                        "type": "UserID"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "user_certificate",
                            "type": "Bytes"
                        },
                        {
                            "name": "revoked_user_certificate",
                            "type": "Bytes"
                        },
                        {
                            "name": "device_certificates",
                            "type": "List<Bytes>"
                        },
                        {
                            "name": "trustchain",
                            "type": "Trustchain"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                }
            ],
            "nested_types": [
                {
                    "label": "Trustchain",
                    "variants": [
                        {
                            "name": "",
                            "fields": [
                                {
                                    "name": "devices",
                                    "type": "List<Bytes>"
                                },
                                {
                                    "name": "users",
                                    "type": "List<Bytes>"
                                },
                                {
                                    "name": "revoked_users",
                                    "type": "List<Bytes>"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "label": "UserCreate",
            "req": {
                "cmd": "user_create",
                "other_fields": [
                    {
                        "name": "user_certificate",
                        "type": "Bytes"
                    },
                    {
                        "name": "device_certificate",
                        "type": "Bytes"
                    },
                    // Same certificates than above, but expurged of human_handle/device_label
                    {
                        "name": "redacted_user_certificate",
                        "type": "Bytes"
                    },
                    {
                        "name": "redacted_device_certificate",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_certification",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_data",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "already_exists",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "active_users_limit_reached",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "UserRevoke",
            "req": {
                "cmd": "user_revoke",
                "other_fields": [
                    {
                        "name": "revoked_user_certificate",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_allowed",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_certification",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": []
                },
                {
                    "status": "already_revoked",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "DeviceCreate",
            "req": {
                "cmd": "device_create",
                "other_fields": [
                    {
                        "name": "device_certificate",
                        "type": "Bytes"
                    },
                    // Same certificate than above, but expurged of device_label
                    {
                        "name": "redacted_device_certificate",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "invalid_certification",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "bad_user_id",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "invalid_data",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "already_exists",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "HumanFind",
            "req": {
                "cmd": "human_find",
                "other_fields": [
                    {
                        "name": "query",
                        "type": "Option<String>"
                    },
                    {
                        "name": "omit_revoked",
                        "type": "Boolean"
                    },
                    {
                        "name": "omit_non_human",
                        "type": "Boolean"
                    },
                    {
                        "name": "page",
                        "type": "NonZeroInteger"
                    },
                    {
                        "name": "per_page",
                        "type": "NonZeroInteger"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "results",
                            "type": "List<HumanFindResultItem>"
                        },
                        {
                            "name": "page",
                            "type": "NonZeroInteger"
                        },
                        {
                            "name": "per_page",
                            "type": "NonZeroInteger"
                        },
                        {
                            "name": "total",
                            "type": "Size"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ],
            "nested_types": [
                {
                    "label": "HumanFindResultItem",
                    "variants": [
                        {
                            "name": "",
                            "fields": [
                                {
                                    "name": "user_id",
                                    "type": "UserID"
                                },
                                {
                                    "name": "human_handle",
                                    "type": "Option<HumanHandle>"
                                },
                                {
                                    "name": "revoked",
                                    "type": "Boolean"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "label": "VlobCreate",
            "req": {
                "cmd": "vlob_create",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    },
                    {
                        "name": "vlob_id",
                        "type": "VlobID"
                    },
                    // If blob contains a signed message, it timestamp cannot be directly enforced
                    // by the backend (given the message is probably also encrypted).
                    // Hence the timestamp is passed in clear so backend can reject the message
                    // if it considers the timestamp invalid. On top of that each client asking
                    // for the message will receive the declared timestamp to check against
                    // the actual timestamp within the message.
                    {
                        "name": "timestamp",
                        "type": "DateTime"
                    },
                    {
                        "name": "blob",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "already_exists",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "VlobRead",
            "req": {
                "cmd": "vlob_read",
                "other_fields": [
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    },
                    {
                        "name": "vlob_id",
                        "type": "VlobID"
                    },
                    {
                        "name": "version",
                        "type": "Option<Version>"
                    },
                    {
                        "name": "timestamp",
                        "type": "Option<DateTime>"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "version",
                            "type": "Version"
                        },
                        {
                            "name": "blob",
                            "type": "Bytes"
                        },
                        {
                            "name": "author",
                            "type": "DeviceID"
                        },
                        {
                            "name": "timestamp",
                            "type": "DateTime"
                        },
                        // This field is used by the client to figure out if its role certificate cache is up-to-date enough
                        // to be able to perform the proper integrity checks on the manifest timestamp.
                        {
                            "name": "author_last_role_granted_on",
                            "type": "Option<DateTime>"
                        }
                    ]
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "bad_version",
                    "other_fields": []
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "VlobUpdate",
            "req": {
                "cmd": "vlob_update",
                "other_fields": [
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    },
                    {
                        "name": "vlob_id",
                        "type": "VlobID"
                    },
                    {
                        "name": "timestamp",
                        "type": "DateTime"
                    },
                    {
                        "name": "version",
                        "type": "Version"
                    },
                    {
                        "name": "blob",
                        "type": "Bytes"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "bad_version",
                    "other_fields": []
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "VlobPollChanges",
            "req": {
                "cmd": "vlob_poll_changes",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "last_checkpoint",
                        "type": "Index"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "changes",
                            "type": "Map<VlobID, Index>"
                        },
                        {
                            "name": "current_checkpoint",
                            "type": "Index"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "VlobListVersions",
            "req": {
                "cmd": "vlob_list_versions",
                "other_fields": [
                    {
                        "name": "vlob_id",
                        "type": "VlobID"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "versions",
                            "type": "Map<Index, (DateTime, DeviceID)>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "in_maintenance",
                    "other_fields": []
                }
            ]
        },
        {
            "label": "VlobMaintenanceGetReencryptionBatch",
            "req": {
                "cmd": "vlob_maintenance_get_reencryption_batch",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    },
                    {
                        "name": "size",
                        "type": "Size"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "batch",
                            "type": "List<ReencryptionBatchEntry>"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_in_maintenance",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "maintenance_error",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        },
        {
            "label": "VlobMaintenanceSaveReencryptionBatch",
            "req": {
                "cmd": "vlob_maintenance_save_reencryption_batch",
                "other_fields": [
                    {
                        "name": "realm_id",
                        "type": "RealmID"
                    },
                    {
                        "name": "encryption_revision",
                        "type": "Index"
                    },
                    {
                        "name": "batch",
                        "type": "List<ReencryptionBatchEntry>"
                    }
                ]
            },
            "reps": [
                {
                    "status": "ok",
                    "other_fields": [
                        {
                            "name": "total",
                            "type": "Size"
                        },
                        {
                            "name": "done",
                            "type": "Size"
                        }
                    ]
                },
                {
                    "status": "not_allowed",
                    "other_fields": []
                },
                {
                    "status": "not_found",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "not_in_maintenance",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                },
                {
                    "status": "bad_encryption_revision",
                    "other_fields": []
                },
                {
                    "status": "maintenance_error",
                    "other_fields": [
                        {
                            "name": "reason",
                            "type": "Option<String>"
                        }
                    ]
                }
            ]
        }
    ]
}
