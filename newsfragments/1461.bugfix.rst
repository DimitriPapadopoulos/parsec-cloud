Improve client disconnection handling in the backend.
